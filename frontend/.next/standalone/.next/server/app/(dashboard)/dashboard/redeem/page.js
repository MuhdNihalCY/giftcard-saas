(()=>{var e={};e.id=622,e.ids=[622],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},27790:e=>{"use strict";e.exports=require("assert")},84770:e=>{"use strict";e.exports=require("crypto")},17702:e=>{"use strict";e.exports=require("events")},92048:e=>{"use strict";e.exports=require("fs")},32615:e=>{"use strict";e.exports=require("http")},32694:e=>{"use strict";e.exports=require("http2")},35240:e=>{"use strict";e.exports=require("https")},19801:e=>{"use strict";e.exports=require("os")},55315:e=>{"use strict";e.exports=require("path")},76162:e=>{"use strict";e.exports=require("stream")},74175:e=>{"use strict";e.exports=require("tty")},17360:e=>{"use strict";e.exports=require("url")},21764:e=>{"use strict";e.exports=require("util")},71568:e=>{"use strict";e.exports=require("zlib")},95321:(e,r,s)=>{"use strict";s.r(r),s.d(r,{GlobalError:()=>l.a,__next_app__:()=>x,originalPathname:()=>m,pages:()=>c,routeModule:()=>u,tree:()=>o}),s(70293),s(6989),s(35866),s(7957);var t=s(23191),a=s(88716),d=s(37922),l=s.n(d),i=s(95231),n={};for(let e in i)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(n[e]=()=>i[e]);s.d(r,n);let o=["",{children:["(dashboard)",{children:["dashboard",{children:["redeem",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,70293)),"/Users/nihal/Desktop/webworks/giftcard-saas/frontend/src/app/(dashboard)/dashboard/redeem/page.tsx"]}]},{}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,6989)),"/Users/nihal/Desktop/webworks/giftcard-saas/frontend/src/app/(dashboard)/layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,35866,23)),"next/dist/client/components/not-found-error"]}]},{layout:[()=>Promise.resolve().then(s.bind(s,7957)),"/Users/nihal/Desktop/webworks/giftcard-saas/frontend/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,35866,23)),"next/dist/client/components/not-found-error"]}],c=["/Users/nihal/Desktop/webworks/giftcard-saas/frontend/src/app/(dashboard)/dashboard/redeem/page.tsx"],m="/(dashboard)/dashboard/redeem/page",x={require:s,loadChunk:()=>Promise.resolve()},u=new t.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/(dashboard)/dashboard/redeem/page",pathname:"/dashboard/redeem",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:o}})},60135:(e,r,s)=>{Promise.resolve().then(s.bind(s,7965))},67126:(e,r,s)=>{Promise.resolve().then(s.bind(s,54681))},7965:(e,r,s)=>{"use strict";s.r(r),s.d(r,{default:()=>f});var t=s(10326),a=s(17577),d=s(74723),l=s(74064),i=s(770),n=s(47375),o=s(89175),c=s(99837),m=s(18069),x=s(51223),u=s(58029),p=s(14507);let h=i.Ry({code:i.Z_().min(1,"Gift card code is required"),amount:i.Rx().positive("Amount must be greater than 0"),location:i.Z_().optional(),notes:i.Z_().optional()});function f(){let{user:e}=(0,u.t)(),[r,s]=(0,a.useState)(null),[i,f]=(0,a.useState)(!1),[g,b]=(0,a.useState)(!1),[y,j]=(0,a.useState)(""),[N,v]=(0,a.useState)(""),[w,C]=(0,a.useState)(""),{register:q,handleSubmit:P,formState:{errors:k},setValue:R,watch:G}=(0,d.cI)({resolver:(0,l.F)(h)}),S=G("code"),_=async e=>{try{f(!0),j(""),s(null);let r=(await m.Z.post("/redemptions/validate",{code:e})).data.data.giftCard;s(r),R("amount",r.balance),C(JSON.stringify({code:r.code,id:r.id}))}catch(e){j(e.response?.data?.error?.message||"Invalid gift card code"),s(null)}finally{f(!1)}},X=async s=>{try{if(b(!0),j(""),v(""),!r){j("Please validate the gift card first");return}if(!e||!e.id){j("You must be logged in to redeem gift cards");return}if(s.amount>r.balance){j(`Amount cannot exceed balance of ${(0,x.xG)(r.balance,r.currency)}`);return}let t=await m.Z.post("/redemptions/redeem/qr",{qrData:w||s.code,amount:s.amount,location:s.location,notes:s.notes});v(`Successfully redeemed ${(0,x.xG)(s.amount,r.currency)}! New balance: ${(0,x.xG)(t.data.data.giftCard.balance,r.currency)}`),await _(s.code)}catch(e){j(e.response?.data?.error?.message||"Redemption failed")}finally{b(!1)}};return(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"mb-8",children:[t.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Redeem Gift Card"}),t.jsx("p",{className:"text-gray-600 mt-1",children:"Enter gift card code or scan QR code to redeem"})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,t.jsxs)(n.Zb,{children:[t.jsx(n.Ol,{children:t.jsx(n.ll,{children:"Enter Gift Card Code"})}),t.jsx(n.aY,{children:(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{children:[t.jsx(o.I,{label:"Gift Card Code",placeholder:"GIFT-XXXX-XXXX-XXXX",error:k.code?.message,...q("code")}),t.jsx(c.z,{type:"button",variant:"outline",className:"mt-2 w-full",onClick:()=>S&&_(S),isLoading:i,children:"Validate Gift Card"})]}),r&&(0,t.jsxs)("div",{className:"p-4 bg-green-50 border border-green-200 rounded-lg",children:[t.jsx("h3",{className:"font-semibold text-gray-900 mb-2",children:"Gift Card Valid"}),(0,t.jsxs)("div",{className:"space-y-1 text-sm",children:[(0,t.jsxs)("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-gray-600",children:"Code:"}),t.jsx("span",{className:"font-mono font-semibold",children:r.code})]}),(0,t.jsxs)("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-gray-600",children:"Balance:"}),t.jsx("span",{className:"font-semibold text-green-600",children:(0,x.xG)(r.balance,r.currency)})]}),(0,t.jsxs)("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-gray-600",children:"Status:"}),t.jsx("span",{className:"font-semibold text-green-600",children:r.status})]})]})]}),y&&t.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded",children:y}),N&&t.jsx("div",{className:"bg-green-50 border border-green-200 text-green-700 px-4 py-3 rounded",children:N}),(0,t.jsxs)("form",{onSubmit:P(X),className:"space-y-4",children:[t.jsx(o.I,{label:"Redemption Amount",type:"number",step:"0.01",min:"0.01",max:r?.balance||0,error:k.amount?.message,disabled:!r,...q("amount",{valueAsNumber:!0})}),t.jsx(o.I,{label:"Location (Optional)",placeholder:"Store location",error:k.location?.message,disabled:!r,...q("location")}),(0,t.jsxs)("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-900 mb-1",children:"Notes (Optional)"}),t.jsx("textarea",{className:"w-full px-4 py-2 border border-gray-300 rounded-lg text-gray-900 bg-white",rows:3,disabled:!r,...q("notes")})]}),t.jsx(c.z,{type:"submit",className:"w-full",isLoading:g,disabled:!r||g,children:"Redeem Gift Card"})]})]})})]}),(0,t.jsxs)(n.Zb,{children:[t.jsx(n.Ol,{children:t.jsx(n.ll,{children:"QR Code Scanner"})}),t.jsx(n.aY,{children:(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"p-4 bg-gray-50 rounded-lg text-center",children:[t.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Scan QR code from customer's gift card"}),t.jsx("div",{className:"bg-white p-4 rounded-lg inline-block",children:t.jsx(p.ZP,{value:w||"Scan QR code to redeem",size:200,level:"H",fgColor:"#000000",bgColor:"#FFFFFF"})}),t.jsx("p",{className:"text-xs text-gray-500 mt-4",children:"QR code will appear after validating a gift card"})]}),(0,t.jsxs)("div",{className:"p-4 bg-blue-50 border border-blue-200 rounded-lg",children:[t.jsx("h4",{className:"font-semibold text-gray-900 mb-2",children:"How to Redeem:"}),(0,t.jsxs)("ol",{className:"list-decimal list-inside space-y-1 text-sm text-gray-700",children:[t.jsx("li",{children:"Enter gift card code or scan QR code"}),t.jsx("li",{children:'Click "Validate Gift Card"'}),t.jsx("li",{children:"Enter redemption amount"}),t.jsx("li",{children:'Click "Redeem Gift Card"'}),t.jsx("li",{children:"Balance will be deducted automatically"})]})]}),r&&t.jsx("div",{className:"p-4 bg-yellow-50 border border-yellow-200 rounded-lg",children:(0,t.jsxs)("p",{className:"text-sm text-gray-700",children:[t.jsx("strong",{children:"Note:"})," Partial redemption is"," ",r.allowPartialRedemption?t.jsx("span",{className:"text-green-600",children:"allowed"}):t.jsx("span",{className:"text-red-600",children:"not allowed"}),". You can only redeem the full balance."]})})]})})]})]})]})}},54681:(e,r,s)=>{"use strict";s.r(r),s.d(r,{default:()=>n});var t=s(10326);s(17577);var a=s(35047),d=s(90434),l=s(58029),i=s(99837);function n({children:e}){let r=(0,a.useRouter)(),{user:s,isAuthenticated:n,clearAuth:o,checkAuth:c}=(0,l.t)();return n?(0,t.jsxs)("div",{className:"min-h-screen bg-gray-50 text-gray-900",children:[t.jsx("nav",{className:"bg-white shadow-sm text-gray-900",children:t.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,t.jsxs)("div",{className:"flex justify-between items-center h-16",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-8",children:[t.jsx(d.default,{href:"/dashboard",className:"text-xl font-bold text-primary-600",children:"\uD83C\uDF81 GiftCard SaaS"}),(0,t.jsxs)("div",{className:"flex space-x-4",children:[t.jsx(d.default,{href:"/dashboard",className:"text-gray-900 hover:text-primary-600 px-3 py-2 rounded-md text-sm font-medium",children:"Dashboard"}),(s?.role==="ADMIN"||s?.role==="MERCHANT")&&(0,t.jsxs)(t.Fragment,{children:[t.jsx(d.default,{href:"/dashboard/gift-cards",className:"text-gray-900 hover:text-primary-600 px-3 py-2 rounded-md text-sm font-medium",children:"Gift Cards"}),t.jsx(d.default,{href:"/dashboard/templates",className:"text-gray-900 hover:text-primary-600 px-3 py-2 rounded-md text-sm font-medium",children:"Templates"}),t.jsx(d.default,{href:"/dashboard/analytics",className:"text-gray-900 hover:text-primary-600 px-3 py-2 rounded-md text-sm font-medium",children:"Analytics"}),t.jsx(d.default,{href:"/dashboard/reports/sales",className:"text-gray-900 hover:text-primary-600 px-3 py-2 rounded-md text-sm font-medium",children:"Reports"}),t.jsx(d.default,{href:"/dashboard/redeem",className:"text-gray-900 hover:text-primary-600 px-3 py-2 rounded-md text-sm font-medium",children:"Redeem"})]}),s?.role==="ADMIN"&&(0,t.jsxs)(t.Fragment,{children:[t.jsx(d.default,{href:"/dashboard/users",className:"text-gray-900 hover:text-primary-600 px-3 py-2 rounded-md text-sm font-medium",children:"Users"}),t.jsx(d.default,{href:"/dashboard/admin/communications",className:"text-gray-900 hover:text-primary-600 px-3 py-2 rounded-md text-sm font-medium",children:"Communications"}),t.jsx(d.default,{href:"/dashboard/admin/communication-logs",className:"text-gray-900 hover:text-primary-600 px-3 py-2 rounded-md text-sm font-medium",children:"Comm Logs"})]}),t.jsx(d.default,{href:"/dashboard/settings",className:"text-gray-900 hover:text-primary-600 px-3 py-2 rounded-md text-sm font-medium",children:"Settings"}),t.jsx(d.default,{href:"/wallet",className:"text-gray-900 hover:text-primary-600 px-3 py-2 rounded-md text-sm font-medium",children:"My Wallet"})]})]}),(0,t.jsxs)("div",{className:"flex items-center space-x-4",children:[t.jsx("span",{className:"text-sm text-gray-900",children:s?.email}),t.jsx(i.z,{variant:"ghost",size:"sm",onClick:()=>{o(),r.push("/")},children:"Logout"})]})]})})}),t.jsx("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:e})]}):null}},89175:(e,r,s)=>{"use strict";s.d(r,{I:()=>i});var t=s(10326),a=s(17577),d=s.n(a),l=s(51223);let i=d().forwardRef(({label:e,error:r,className:s,id:d,...i},n)=>{let o=(0,a.useId)(),c=d||o;return(0,t.jsxs)("div",{className:"w-full",children:[e&&t.jsx("label",{htmlFor:c,className:"block text-sm font-medium text-gray-900 mb-1",children:e}),t.jsx("input",{ref:n,id:c,className:(0,l.cn)("w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent","text-gray-900 bg-white placeholder:text-gray-400",r?"border-red-500":"border-gray-300",s),...i}),r&&t.jsx("p",{className:"mt-1 text-sm text-red-600",children:r})]})});i.displayName="Input"},70293:(e,r,s)=>{"use strict";s.r(r),s.d(r,{default:()=>t});let t=(0,s(68570).createProxy)(String.raw`/Users/nihal/Desktop/webworks/giftcard-saas/frontend/src/app/(dashboard)/dashboard/redeem/page.tsx#default`)},6989:(e,r,s)=>{"use strict";s.r(r),s.d(r,{default:()=>t});let t=(0,s(68570).createProxy)(String.raw`/Users/nihal/Desktop/webworks/giftcard-saas/frontend/src/app/(dashboard)/layout.tsx#default`)}};var r=require("../../../../webpack-runtime.js");r.C(e);var s=e=>r(r.s=e),t=r.X(0,[371,672,434,207,148,407,683],()=>s(95321));module.exports=t})();